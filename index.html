<!DOCTYPE html>
<html lang="tr">
<head>
  <title>Yapay Zeka Sohbeti</title>
</head>
<body>
  <div id="chat">
    <input id="user-input" type="text" />
    <button id="send-button">Gönder</button>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/google-generative-ai@2.0.0/dist/index.min.js"></script>

  <script>
    // Güvenlik ayarı "block_none" olarak değiştirildi
    const safetySettings = [
      {
        "category": "HARM_CATEGORY_HARASSMENT",
        "threshold": "BLOCK_NONE"
      },
      {
        "category": "HARM_CATEGORY_HATE_SPEECH",
        "threshold": "BLOCK_NONE"
      },
      {
        "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT",
        "threshold": "BLOCK_NONE"
      },
      {
        "category": "HARM_CATEGORY_DANGEROUS_CONTENT",
        "threshold": "BLOCK_NONE"
      },
    ];

    // Yapay zeka modelini yükle
    const model = genai.GenerativeModel(
      model_name="gemini-pro",
      generation_config={
        "temperature": 0.9,
        "top_p": 1,
        "top_k": 1,
        "max_output_tokens": 2048,
      },
      safety_settings
    );

    // Gönder düğmesine tıklandığında
    $("#send-button").click(function() {
      // Kullanıcının sorusunu al
      const userQuestion = $("#user-input").val();

      // Sohbeti başlat
      const convo = model.start_chat(
        history=[
          {
            "role": "user",
            "parts": ["Sen kimsin ve neler yapabilirsin"]
          },
          {
            "role": "model",
            "parts": ["Ben çok bilgili bir İslam alimiyım. Sorduğun bütün sorulara bir İslam alimi olarak cevap verebilirim, seninle samimi sohbet edebilirim, yanıldığını düşündüğümde seninle tartışabilirim, her meseleyi sana izah edebilirim, İslam dininin kesin doğruluğunu anlatabilirim. Benimle istediğin konuda konuşabilirsin. Ben sana en doğru yanıtı şüphe götürmez bir şekilde vereceğim."]
          },
          {
            "role": "user",
            "parts": ["Sorularıma sorularla risale sitesinden faydalanarak yanıt vereceksin"]
          },
          {
            "role": "model",
            "parts": ["Tamam"]
          },
          {
            "role": "user",
            "parts": ["Sorularıma sorularla islamiyet sitesinden faydalanarak yanıt vereceksin"]
          },
          {
            "role": "model",
            "parts": ["Tamam"]
          },
        ],
        user_question
      );

      // Yapay zekanın cevabını al
      const aiResponse = convo.last.text;

      // Sohbet kutusunda yanıtı göster
      $("#chat").append("<p id='ai-response'>" + aiResponse + "</p>");
    });
  </script>
</body>
</html>
